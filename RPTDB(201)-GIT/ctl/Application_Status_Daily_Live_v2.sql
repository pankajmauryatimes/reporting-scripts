export to /home/datareq/generic_etl/wip/Application_Status_Daily_load_v2.csv of del modified by coldel, datesiso select 1 as category, T.source, sum(T.Native_counts) as Native_counts , sum(T.Trans_counts) as Trans_counts from (select feature_name as source, count(1) as Native_counts,0 as Trans_counts from SITE_INBOX_RESPONSE where date_responded = current date -1 day and trim(feature_name) in ('EMAIL', 'email_apply_bucket', 'TJAJD', 'TJMLR', 'TJAJD_LKD_LOG', 'TJAJD_LKD_REG', 'APLCNF_REC', 'EJM', 'REC_RPN_JD', 'SIMJ_JD', 'TJCAND_SJM', 'TJJD', 'TJJD_LKD_LOG', 'TJJD_LKD_REG', 'TJLKD', 'TJLKD_LKD_LOG', 'TJLKD_LKD_REG', 'TJCAND', 'JDSIMILAR', 'JI_LKD_LOG', 'JI_LKD_REG', 'WALKIN', 'TJMLR_HIRE', 'RECJOB', 'TJPF', 'TJPFBJ', 'TJPFRV', 'TJPFSJ', 'TJ_INBOX', 'TJ_INB', 'TJ_INBOX_LKD_LOG', 'TJ_INBOX_LKD_REG', 'TJPFSRP', 'TJSRP', 'TJSRP_MULTI', 'TJSEO', 'TG', 'ASKME', 'REFERRAL', 'REFERRAL_LKD_LOG', 'REFERRAL_LKD_REG', 'TJ_ASKME', 'VRSE','REFER') group by feature_name union select 'Jobbuzz' as source, count(1) as Native_counts,0 as Trans_counts from SITE_INBOX_RESPONSE where date_responded = current date -1 day and trim(feature_name) like 'JB%' group by feature_name union select trim(SIR.FEATURE_NAME) as source,0 as Native_counts, count(1) as Trans_counts from (select UA.AD_ID from USER_AD UA, ADMIN_GROUPUSER_MAP agm where UA.SUB_CAT_ID = 2710 and agm.LOGIN_SRL_NO = ua.LOGIN_SRL_NO and agm.ADMIN_LOGIN_ID =  'tj_externaljobs_2' ) T1, EXTERNAL_JOB_RESPONSE SIR where SIR.JOB_ID = T1.AD_ID and SIR.DATE_RESPONDED between char(current date -1 day ,ISO)||' 00:00:00.00' and char(current date -1 day ,ISO)||' 23:59:59.99' and trim(SIR.FEATURE_NAME) in ('EMAIL', 'email_apply_bucket', 'TJAJD', 'TJMLR', 'TJAJD_LKD_LOG', 'TJAJD_LKD_REG', 'APLCNF_REC', 'EJM', 'REC_RPN_JD', 'SIMJ_JD', 'TJCAND_SJM', 'TJJD', 'TJJD_LKD_LOG', 'TJJD_LKD_REG', 'TJLKD', 'TJLKD_LKD_LOG', 'TJLKD_LKD_REG', 'TJCAND', 'JDSIMILAR', 'JI_LKD_LOG', 'JI_LKD_REG', 'WALKIN', 'TJMLR_HIRE', 'RECJOB', 'TJPF', 'TJPFBJ', 'TJPFRV', 'TJPFSJ', 'TJ_INBOX', 'TJ_INB', 'TJ_INBOX_LKD_LOG', 'TJ_INBOX_LKD_REG', 'TJPFSRP', 'TJSRP', 'TJSRP_MULTI', 'TJSEO', 'TG', 'ASKME', 'REFERRAL', 'REFERRAL_LKD_LOG', 'REFERRAL_LKD_REG', 'TJ_ASKME', 'VRSE') group by trim(SIR.FEATURE_NAME) union select 'Jobbuzz' as source,0 as Native_counts, count(1) as Trans_counts from (select UA.AD_ID from USER_AD UA, ADMIN_GROUPUSER_MAP agm where UA.SUB_CAT_ID = 2710 and agm.LOGIN_SRL_NO = ua.LOGIN_SRL_NO and agm.ADMIN_LOGIN_ID =  'tj_externaljobs_2' ) T2, EXTERNAL_JOB_RESPONSE SIR where SIR.JOB_ID = T2.AD_ID and SIR.DATE_RESPONDED between char(current date -1 day ,ISO)||' 00:00:00.00' and char(current date -1 day ,ISO)||' 23:59:59.99' and trim(SIR.FEATURE_NAME) like 'JB%' ) T group by T.source union select 2 as category, T.source, sum(T.Native_counts) as Native_counts , sum(Trans_counts) as Trans_counts from (select feature_name as source, count(1) as Native_counts,0 as Trans_counts from SITE_INBOX_RESPONSE where date_responded = current date -1 day and (trim(feature_name) like 'TJANDRD%' OR trim(feature_name) like 'TJIOS%' OR trim(feature_name) like 'TJMOB%' OR trim(feature_name) like 'ISM%' OR trim(feature_name) like 'TJ_J2%' or trim(feature_name) like 'TJWINMOB%' ) group by feature_name union select trim(SIR.FEATURE_NAME) as source, 0 as Native_counts, count(1) as trans_counts from (select UA.AD_ID from USER_AD UA, ADMIN_GROUPUSER_MAP agm where UA.SUB_CAT_ID = 2710 and agm.LOGIN_SRL_NO = ua.LOGIN_SRL_NO and agm.ADMIN_LOGIN_ID =  'tj_externaljobs_2') T1, EXTERNAL_JOB_RESPONSE SIR where SIR.JOB_ID = T1.AD_ID and SIR.DATE_RESPONDED between char(current date -1 day ,ISO)||' 00:00:00.00' and char(current date -1 day ,ISO)||' 23:59:59.99' and (trim(feature_name) like 'TJANDRD%' OR trim(feature_name) like 'TJIOS%' OR trim(feature_name) like 'TJMOB%' OR trim(feature_name) like 'ISM%' OR trim(feature_name) like 'TJ_J2%' or trim(feature_name) like 'TJWINMOB%') group by trim(SIR.FEATURE_NAME)) T group by T.source union select 3 as category, T.source, sum(T.Native_counts) as Native_counts , sum(Trans_counts) as Trans_counts from (select feature_name as source, count(1) as Native_counts,0 as trans_counts from SITE_INBOX_RESPONSE where date_responded = current date -1 day and (trim(feature_name) not like ('JB%') and trim(feature_name) not like ('TJANDRD%') and trim(feature_name) not like ('TJIOS%') and trim(feature_name) not like 'TJMOB%' and trim(feature_name) not like 'ISM%' and trim(feature_name) not like 'TJ_J2%' and trim(feature_name) not like 'TJWINMOB%' and trim(feature_name) not in ('EMAIL', 'email_apply_bucket', 'TJAJD', 'TJMLR', 'TJAJD_LKD_LOG', 'TJAJD_LKD_REG', 'APLCNF_REC', 'EJM', 'REC_RPN_JD', 'SIMJ_JD', 'TJCAND_SJM', 'TJJD', 'TJJD_LKD_LOG', 'TJJD_LKD_REG', 'TJLKD', 'TJLKD_LKD_LOG', 'TJLKD_LKD_REG', 'TJCAND', 'JDSIMILAR', 'JI_LKD_LOG', 'JI_LKD_REG', 'WALKIN', 'TJMLR_HIRE', 'RECJOB', 'TJPF', 'TJPFBJ', 'TJPFRV', 'TJPFSJ', 'TJ_INBOX', 'TJ_INB', 'TJ_INBOX_LKD_LOG', 'TJ_INBOX_LKD_REG', 'TJPFSRP', 'TJSRP', 'TJSRP_MULTI', 'TJSEO', 'TG', 'ASKME', 'REFERRAL', 'REFERRAL_LKD_LOG', 'REFERRAL_LKD_REG', 'TJ_ASKME', 'VRSE','REFER')) group by feature_name union select trim(SIR.FEATURE_NAME) as source,0 as Native_counts, count(1) as trans_counts from (select UA.AD_ID from USER_AD UA, ADMIN_GROUPUSER_MAP agm where UA.SUB_CAT_ID = 2710 and agm.LOGIN_SRL_NO = ua.LOGIN_SRL_NO and agm.ADMIN_LOGIN_ID =  'tj_externaljobs_2') T1, EXTERNAL_JOB_RESPONSE SIR where SIR.JOB_ID = T1.AD_ID and SIR.DATE_RESPONDED between char(current date -1 day ,ISO)||' 00:00:00.00' and char(current date -1 day ,ISO)|| ' 23:59:59.99' and (trim(feature_name) not like ('JB%') and trim(feature_name) not like ('TJANDRD%') and trim(feature_name) not like ('TJIOS%') and trim(feature_name) not like 'TJMOB%' and trim(feature_name) not like 'ISM%' and trim(feature_name) not like 'TJ_J2%' and trim(feature_name) not like 'TJWINMOB%' and trim(SIR.FEATURE_NAME) not in ('EMAIL', 'email_apply_bucket', 'TJAJD', 'TJMLR', 'TJAJD_LKD_LOG', 'TJAJD_LKD_REG', 'APLCNF_REC', 'EJM', 'REC_RPN_JD', 'SIMJ_JD', 'TJCAND_SJM', 'TJJD', 'TJJD_LKD_LOG', 'TJJD_LKD_REG', 'TJLKD', 'TJLKD_LKD_LOG', 'TJLKD_LKD_REG', 'TJCAND', 'JDSIMILAR', 'JI_LKD_LOG', 'JI_LKD_REG', 'WALKIN', 'TJMLR_HIRE', 'RECJOB', 'TJPF', 'TJPFBJ', 'TJPFRV', 'TJPFSJ', 'TJ_INBOX', 'TJ_INB', 'TJ_INBOX_LKD_LOG', 'TJ_INBOX_LKD_REG', 'TJPFSRP', 'TJSRP', 'TJSRP_MULTI', 'TJSEO', 'TG', 'ASKME', 'REFERRAL', 'REFERRAL_LKD_LOG', 'REFERRAL_LKD_REG', 'TJ_ASKME', 'VRSE','REFER')) group by trim(SIR.FEATURE_NAME)) T group by T.source with ur

