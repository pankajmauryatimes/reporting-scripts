export to /home/datareq/generic_etl/wip/exp_wise_stage_relaxation.txt of DEL MODIFIED by coldel, datesiso select 'Relaxation' as Session,'Stage 2' as stage,'PAID' as source, lc.campaign_id,case when coalesce(rra.work_exp,0) between 1 and 2 then '0-2' else '2+' end as work_exp,count(1) as stage_n_count  from user u, user_ad ua, lead_capture lc, rcrt_resume_ads rra  where u.login_create_date between ((current date - day(current date) day) - day((current date - day(current date) day)) day) +1 day and (current date - day(current date) day)   and ua.login_id = u.login_id   and ua.net_status = 11   and ua.sub_cat_id= 2711  and u.agent= 'I'  and lc.ad_id = ua.ad_id    and rra.ad_id = ua.ad_id   and rra.view IN ('Y','y')  group by lc.campaign_id,case when coalesce(rra.work_exp,0) between 1 and 2 then '0-2' else '2+' end   union select 'Relaxation' as Session,'Stage 1.5' as stage,'PAID' as source, lc.campaign_id,case when coalesce(rra.work_exp,0) between 1 and 2 then '0-2' else '2+' end as work_exp,count(1) as stage_n_count  from user u, user_ad ua, lead_capture lc, rcrt_resume_ads rra  where u.login_create_date between ((current date - day(current date) day) - day((current date - day(current date) day)) day) +1 day and (current date - day(current date) day)    and ua.login_id = u.login_id    and ua.net_status = 20    and ua.sub_cat_id= 2711   and u.agent= 'I'   and lc.ad_id = ua.ad_id    and rra.ad_id = ua.ad_id    and rra.view IN ('Y','y')    and rra.saved_resume_path is not null group by lc.campaign_id,case when coalesce(rra.work_exp,0) between 1 and 2 then '0-2' else '2+' end  union select 'Relaxation' as Session,'Stage 1' as stage,'PAID' as source, lc.campaign_id,case when coalesce(rra.work_exp,0) between 1 and 2 then '0-2' else '2+' end as work_exp,count(1) as stage_n_count  from user u, user_ad ua, lead_capture lc, rcrt_resume_ads rra  where u.login_create_date between ((current date - day(current date) day) - day((current date - day(current date) day)) day) +1 day and (current date - day(current date) day)    and ua.login_id = u.login_id    and ua.net_status = 20    and ua.sub_cat_id= 2711   and u.agent= 'I'   and lc.ad_id = ua.ad_id    and rra.ad_id = ua.ad_id    and rra.view IN ('Y','y')    and rra.saved_resume_path is null group by lc.campaign_id,case when coalesce(rra.work_exp,0) between 1 and 2 then '0-2' else '2+' end order by 5 desc with ur 

export to /home/datareq/generic_etl/wip/location_wise_stage_relaxation.txt of DEL MODIFIED by coldel, datesiso  select Session,stage,source,CAMPAIGN_ID,(select CASE WHEN lv.LOC_CITY = -1 THEN 'NOT DEFINE' ELSE LM.LOCATION_NAME END from tcadmin.RCRT_LOCATION_MAS LM where LM.LOCATION_ID = lv.LOC_CITY) AS Location,STAGE_N_COUNT from (select 'Relaxation' as Session,'Stage 2' as stage,'PAID' as source, lc.campaign_id,rra.loc_city,count(1) as stage_n_count  from user u, user_ad ua, lead_capture lc, rcrt_resume_ads rra  where u.login_create_date between ((current date - day(current date) day) - day((current date - day(current date) day)) day) +1 day and (current date - day(current date) day)   and ua.login_id = u.login_id   and ua.net_status = 11   and ua.sub_cat_id= 2711  and u.agent= 'I'  and lc.ad_id = ua.ad_id    and rra.ad_id = ua.ad_id   and rra.view IN ('Y','y') group by lc.campaign_id,rra.loc_city union select 'Relaxation' as Session,'Stage 1.5' as stage,'PAID' as source, lc.campaign_id,rra.loc_city,count(1) as stage_n_count  from user u, user_ad ua, lead_capture lc, rcrt_resume_ads rra  where u.login_create_date between ((current date - day(current date) day) - day((current date - day(current date) day)) day) +1 day and (current date - day(current date) day)    and ua.login_id = u.login_id    and ua.net_status = 20    and ua.sub_cat_id= 2711   and u.agent= 'I'   and lc.ad_id = ua.ad_id    and rra.ad_id = ua.ad_id    and rra.view IN ('Y','y')    and rra.saved_resume_path is not null group by lc.campaign_id,rra.loc_city  union select 'Relaxation' as Session,'Stage 1' as stage,'PAID' as source, lc.campaign_id,rra.loc_city,count(1) as stage_n_count  from user u, user_ad ua, lead_capture lc, rcrt_resume_ads rra  where u.login_create_date between ((current date - day(current date) day) - day((current date - day(current date) day)) day) +1 day and (current date - day(current date) day)    and ua.login_id = u.login_id    and ua.net_status = 20    and ua.sub_cat_id= 2711   and u.agent= 'I'   and lc.ad_id = ua.ad_id    and rra.ad_id = ua.ad_id    and rra.view IN ('Y','y')    and rra.saved_resume_path is null group by lc.campaign_id,rra.loc_city order by 5 desc )lv with ur
 
 export to /home/datareq/generic_etl/wip/Aggregate_stage_wise_inorganic_count.txt of DEL MODIFIED by coldel, datesiso  select Session,stage,source,CAMPAIGN_ID,STAGE_N_COUNT from (select 'Relaxation' as Session,'Stage 2' as stage,'PAID' as source, campaign_id,count(1) as stage_n_count  from user u, user_ad ua, lead_capture lc, rcrt_resume_ads rra  where u.login_create_date between ((current date - day(current date) day) - day((current date - day(current date) day)) day) +1 day and (current date - day(current date) day)   and ua.login_id = u.login_id   and ua.net_status = 11   and ua.sub_cat_id= 2711  and u.agent= 'I'  and lc.ad_id = ua.ad_id    and rra.ad_id = ua.ad_id   and rra.view IN ('Y','y') group by campaign_id  union select 'Relaxation' as Session,'Stage 1.5' as stage,'PAID' as source, campaign_id,count(1) as stage_n_count  from user u, user_ad ua, lead_capture lc, rcrt_resume_ads rra  where u.login_create_date between ((current date - day(current date) day) - day((current date - day(current date) day)) day) +1 day and (current date - day(current date) day)    and ua.login_id = u.login_id    and ua.net_status = 20    and ua.sub_cat_id= 2711   and u.agent= 'I'   and lc.ad_id = ua.ad_id    and rra.ad_id = ua.ad_id    and rra.view IN ('Y','y')    and rra.saved_resume_path is not null group by campaign_id  union select 'Relaxation' as Session,'Stage 1' as stage,'PAID' as source, campaign_id,count(1) as stage_n_count  from user u, user_ad ua, lead_capture lc, rcrt_resume_ads rra  where u.login_create_date between ((current date - day(current date) day) - day((current date - day(current date) day)) day) +1 day and (current date - day(current date) day)    and ua.login_id = u.login_id    and ua.net_status = 20    and ua.sub_cat_id= 2711   and u.agent= 'I'   and lc.ad_id = ua.ad_id    and rra.ad_id = ua.ad_id    and rra.view IN ('Y','y')    and rra.saved_resume_path is null  group by campaign_id order by 5 desc )lv  with ur
 
 export to /home/datareq/generic_etl/wip/exp_wise_stage_organic.txt of DEL MODIFIED by coldel, datesiso select 'Relaxation' as Session,'Stage 2' as stage,'NONPAID' as source, '' as campaign_id,case when coalesce(rra.work_exp,0) between 1 and 2 then '0-2' else '2+' end as work_exp,count(1) as stage_n_count  from user u, user_ad ua, rcrt_resume_ads rra  where u.login_create_date between ((current date - day(current date) day) - day((current date - day(current date) day)) day) +1 day and (current date - day(current date) day)   and ua.login_id = u.login_id   and ua.net_status = 11   and ua.sub_cat_id= 2711  and u.agent= 'I'  and rra.ad_id = ua.ad_id   and rra.view IN ('Y','y')    and not exists (select 1 from lead_capture lc where lc.ad_id = ua.ad_id ) group by case when coalesce(rra.work_exp,0) between 1 and 2 then '0-2' else '2+' end   union select 'Relaxation' as Session,'Stage 1.5' as stage,'NONPAID' as source, '' as campaign_id,case when coalesce(rra.work_exp,0) between 1 and 2 then '0-2' else '2+' end as work_exp,count(1) as stage_n_count  from user u, user_ad ua, rcrt_resume_ads rra  where u.login_create_date between ((current date - day(current date) day) - day((current date - day(current date) day)) day) +1 day and (current date - day(current date) day)    and ua.login_id = u.login_id    and ua.net_status = 20    and ua.sub_cat_id= 2711   and u.agent= 'I'   and rra.ad_id = ua.ad_id    and rra.view IN ('Y','y')    and rra.saved_resume_path is not null    and not exists (select 1 from lead_capture lc where lc.ad_id = ua.ad_id ) group by case when coalesce(rra.work_exp,0) between 1 and 2 then '0-2' else '2+' end  union select 'Relaxation' as Session,'Stage 1' as stage,'NONPAID' as source, '' as campaign_id, case when coalesce(rra.work_exp,0) between 1 and 2 then '0-2' else '2+' end as work_exp,count(1) as stage_n_count  from user u, user_ad ua, rcrt_resume_ads rra  where u.login_create_date between ((current date - day(current date) day) - day((current date - day(current date) day)) day) +1 day and (current date - day(current date) day)    and ua.login_id = u.login_id    and ua.net_status = 20    and ua.sub_cat_id= 2711   and u.agent= 'I'   and rra.ad_id = ua.ad_id    and rra.view IN ('Y','y')    and rra.saved_resume_path is null    and not exists (select 1 from lead_capture lc where lc.ad_id = ua.ad_id ) group by case when coalesce(rra.work_exp,0) between 1 and 2 then '0-2' else '2+' end order by 5 desc with ur  
 
 export to /home/datareq/generic_etl/wip/location_wise_stage_organic.txt of DEL MODIFIED by coldel, datesiso  select Session,stage,source,campaign_id,(select CASE WHEN lv.LOC_CITY = -1 THEN 'NOT DEFINE' ELSE LM.LOCATION_NAME END from tcadmin.RCRT_LOCATION_MAS LM where LM.LOCATION_ID = lv.LOC_CITY) AS Location,STAGE_N_COUNT from (select 'Relaxation' as Session,'Stage 2' as stage,'NONPAID' as source, '' as campaign_id,rra.loc_city,count(1) as stage_n_count  from user u, user_ad ua, rcrt_resume_ads rra  where u.login_create_date between ((current date - day(current date) day) - day((current date - day(current date) day)) day) +1 day and (current date - day(current date) day)   and ua.login_id = u.login_id   and ua.net_status = 11   and ua.sub_cat_id= 2711  and u.agent= 'I'  and rra.ad_id = ua.ad_id   and rra.view IN ('Y','y')   and not exists (select 1 from lead_capture lc where lc.ad_id = ua.ad_id ) group by rra.loc_city union select 'Relaxation' as Session,'Stage 1.5' as stage,'NONPAID' as source, '' as campaign_id,rra.loc_city,count(1) as stage_n_count  from user u, user_ad ua, rcrt_resume_ads rra  where u.login_create_date between ((current date - day(current date) day) - day((current date - day(current date) day)) day) +1 day and (current date - day(current date) day)    and ua.login_id = u.login_id    and ua.net_status = 20    and ua.sub_cat_id= 2711   and u.agent= 'I'   and rra.ad_id = ua.ad_id    and rra.view IN ('Y','y')    and rra.saved_resume_path is not null    and not exists (select 1 from lead_capture lc where lc.ad_id = ua.ad_id ) group by rra.loc_city  union select 'Relaxation' as Session,'Stage 1' as stage,'NONPAID' as source, '' as campaign_id,rra.loc_city,count(1) as stage_n_count  from user u, user_ad ua, rcrt_resume_ads rra  where u.login_create_date between ((current date - day(current date) day) - day((current date - day(current date) day)) day) +1 day and (current date - day(current date) day)    and ua.login_id = u.login_id    and ua.net_status = 20    and ua.sub_cat_id= 2711   and u.agent= 'I'   and rra.ad_id = ua.ad_id    and rra.view IN ('Y','y')    and rra.saved_resume_path is null    and not exists (select 1 from lead_capture lc where lc.ad_id = ua.ad_id ) group by rra.loc_city order by 5 desc )lv with ur  
 
export to /home/datareq/generic_etl/wip/Aggregate_stage_wise_organic_count.txt of DEL MODIFIED by coldel, datesiso  select Session,stage,source,promotion_id,STAGE_N_COUNT from (select 'Organic' as Session,'Stage 2' as stage,'NONPAID' as source,'' as promotion_id, count(1) as stage_n_count  from user u, user_ad ua, rcrt_resume_ads rra  where u.login_create_date between ((current date - day(current date) day) - day((current date - day(current date) day)) day) +1 day and (current date - day(current date) day)   and ua.login_id = u.login_id   and ua.net_status = 11   and ua.sub_cat_id= 2711  and u.agent= 'I'  and rra.ad_id = ua.ad_id   and rra.view IN ('Y','y')   and not exists (select 1 from lead_capture lc where lc.ad_id = ua.ad_id )  union select 'Organic' as Session,'Stage 1.5' as stage,'NONPAID' as source,'' as promotion_id, count(1) as stage_n_count  from user u, user_ad ua, rcrt_resume_ads rra  where u.login_create_date between ((current date - day(current date) day) - day((current date - day(current date) day)) day) +1 day and (current date - day(current date) day)    and ua.login_id = u.login_id    and ua.net_status = 20    and ua.sub_cat_id= 2711   and u.agent= 'I'   and rra.ad_id = ua.ad_id    and rra.view IN ('Y','y')    and rra.saved_resume_path is not null    and not exists (select 1 from lead_capture lc where lc.ad_id = ua.ad_id )  union select 'Organic' as Session,'Stage 1' as stage,'NONPAID' as source, '' as promotion_id,count(1) as stage_n_count  from user u, user_ad ua, rcrt_resume_ads rra  where u.login_create_date between ((current date - day(current date) day) - day((current date - day(current date) day)) day) +1 day and (current date - day(current date) day)    and ua.login_id = u.login_id    and ua.net_status = 20    and ua.sub_cat_id= 2711   and u.agent= 'I'   and rra.ad_id = ua.ad_id    and rra.view IN ('Y','y')    and rra.saved_resume_path is null    and not exists (select 1 from lead_capture lc where lc.ad_id = ua.ad_id ) order by 5 desc )lv with ur

export to /home/datareq/generic_etl/wip/exp_wise_stage_older_converts_count.txt of DEL MODIFIED by coldel, datesiso select 400 as id, 'Older Converts (0-2 years)' as desc, year(current date - day(current date) DAY) as YEAR1, month(current date - day(current date) DAY) as MONTH1, count(distinct A.Login_id) from RESUME_STATUS_CHANGE_HISTORY A, USER U ,USER_AD ua, RCRT_RESUME_ADS rra where A.STATUS_CHANGE_DATETIME between char(((current date - day(current date) day) - day((current date - day(current date) day)) day) +1 day) || ' 00:00:00.00' and char((current date - day(current date) day)) || ' 23:59:59.00'  AND U.Login_id = A.login_Id  AND u.login_srl_no = ua.login_srl_no and ua.ad_id = rra.ad_id AND U.login_create_date < ((current date - day(current date) day) - day((current date - day(current date) day)) day) +1 day AND A.CURR_NET_STATUS = 11 and coalesce(rra.work_exp,0) <= 2 union select 500 as id, 'Older Converts (2+ years)' as desc, year(current date - day(current date) DAY) as YEAR1, month(current date - day(current date) DAY) as MONTH1, count(distinct A.Login_id) from RESUME_STATUS_CHANGE_HISTORY A, USER U ,USER_AD ua, RCRT_RESUME_ADS rra where A.STATUS_CHANGE_DATETIME between char(((current date - day(current date) day) - day((current date - day(current date) day)) day) +1 day) || ' 00:00:00.00' and char((current date - day(current date) day)) || ' 23:59:59.00'  AND U.Login_id = A.login_Id  AND u.login_srl_no = ua.login_srl_no and ua.ad_id = rra.ad_id AND U.login_create_date < ((current date - day(current date) day) - day((current date - day(current date) day)) day) +1 day AND A.CURR_NET_STATUS = 11 and coalesce(rra.work_exp,0) > 2 union select 600 as id, 'Monthly unique candidates applied through native job alerts' as desc, year(current date - day(current date) DAY) as YEAR1, month(current date - day(current date) DAY) as MONTH1, count(distinct RESUME_ID) as candidate_count from SITE_INBOX_RESPONSE where DATE_RESPONDED between (current date - day(current date - 1 DAY) DAYS) and (current date - 1 DAY) and FEATURE_NAME in ('TJ_INBOX', 'TJAJD', 'TJAJD_LKD_LOG', 'TJAJD_LKD_REG', 'TJMLR', 'TJANDRD_JA_EMPLOYER', 'TJANDRD_JA_MESSAGES', 'TJANDRD_JA_NOTIFI', 'TJANDRD_JA_NOTIFY', 'TJANDRD_JOBDET', 'TJIOS_JA_EMPLOYER', 'TJIOS_JA_NOTIFI', 'TJIOS_JOBDET', 'TJMOB_JA_EMPLOYER', 'TJMOB_JA_NOTIFI', 'TJMOB_JOBDET') union select 700 as id, 'Monthly unique candidates applied through transcribed job alerts' as desc, year(current date - day(current date) DAY) as YEAR1, month(current date - day(current date) DAY) as MONTH1, count(distinct RESUME_ID) as candidate_count from EXTERNAL_JOB_RESPONSE where DATE_RESPONDED between char(((current date - day(current date) day) - day((current date - day(current date) day)) day) +1 day) || ' 00:00:00.00' and char((current date - day(current date) day)) || ' 23:59:59.00' and FEATURE_NAME in ('TJ_INBOX', 'TJAJD', 'TJAJD_LKD_LOG', 'TJAJD_LKD_REG', 'TJMLR', 'TJANDRD_JA_EMPLOYER', 'TJANDRD_JA_MESSAGES', 'TJANDRD_JA_NOTIFI', 'TJANDRD_JA_NOTIFY', 'TJANDRD_JOBDET', 'TJIOS_JA_EMPLOYER', 'TJIOS_JA_NOTIFI', 'TJIOS_JOBDET', 'TJMOB_JA_EMPLOYER', 'TJMOB_JA_NOTIFI', 'TJMOB_JOBDET') union select 800 as id, 'Monthly Unique Candidate received Job Alert' as desc, year(current date - day(current date) DAY) as YEAR1, month(current date - day(current date) DAY) as MONTH1, count(distinct LOGIN_ID) from mail_track where CREATE_DATETIME between char(((current date - day(current date) day) - day((current date - day(current date) day)) day) +1 day) || ' 00:00:00.00' and char((current date - day(current date) day)) || ' 23:59:59.00' with ur
