export to /home/datareq/generic_etl/logs/hourly_Alert_sent_stat.txt of del modified by coldel, datesiso select trim(char(K.sent_date)) ||left(' ',15 - length(Trim(char(K.sent_date)))) ||'|'|| trim(char(K.sent_hour)) ||left(' ',4 - length(Trim(char(K.sent_hour)))) ||'|'|| trim(char(K.A_20000)) ||left(' ',10 - length(Trim(char(K.A_20000)))) ||'|'|| trim(char(K.A_20500)) ||left(' ',10 - length(Trim(char(K.A_20500)))) ||'|'|| trim(char(K.A_21000)) ||left(' ',10 - length(Trim(char(K.A_21000)))) ||'|'||  trim(char(K.A_1009)) ||left(' ',10 - length(Trim(char(K.A_1009)))) ||'|'|| trim(char(K.A_1005)) ||left(' ',10 - length(Trim(char(K.A_1005)))) ||'|'|| trim(char(K.A_22000)) ||left(' ',10 - length(Trim(char(K.A_22000)))) ||'|'|| trim(char(K.A_30000)) ||left(' ',10 - length(Trim(char(K.A_30000)))) ||'|'|| trim(char(K.A_35000)) ||left(' ',10 - length(Trim(char(K.A_35000)))) ||'|'|| trim(char(K.A_20100)) ||left(' ',10 - length(Trim(char(K.A_20100)))) ||'|' ||trim(char(K.A_20400)) ||left(' ',10 - length(Trim(char(K.A_20400)))) ||'|' ||trim(char(K.A_40000)) ||left(' ',10 - length(Trim(char(K.A_40000)))) ||'|' from   (select T.sent_date, T.sent_hour,  SUM(CASE WHEN A.alertcombination_id = 20000 THEN T.alert_count ELSE 0 END) as A_20000 ,  SUM(CASE WHEN A.alertcombination_id = 20500 THEN T.alert_count ELSE 0 END) as A_20500,  SUM(CASE WHEN A.alertcombination_id = 21000 THEN T.alert_count ELSE 0 END) as A_21000,  SUM(CASE WHEN A.alertcombination_id = 1009 THEN T.alert_count ELSE 0 END) as A_1009,  SUM(CASE WHEN A.alertcombination_id = 1005 THEN T.alert_count ELSE 0 END) as A_1005, SUM(CASE WHEN A.alertcombination_id = 22000 THEN T.alert_count ELSE 0 END) as A_22000,  SUM(CASE WHEN A.alertcombination_id = 30000 THEN T.alert_count ELSE 0 END) as A_30000,  SUM(CASE WHEN A.alertcombination_id = 35000 THEN T.alert_count ELSE 0 END) as A_35000,  SUM(CASE WHEN A.alertcombination_id = 20100 THEN T.alert_count ELSE 0 END) as A_20100, SUM(CASE WHEN A.alertcombination_id = 20400 THEN T.alert_count ELSE 0 END) as A_20400, SUM(CASE WHEN A.alertcombination_id = 40000 THEN T.alert_count ELSE 0 END) as A_40000 from (select date(mt.CREATE_DATETIME) as sent_date, hour(mt.CREATE_DATETIME) as sent_hour, mt.combination_id, count(1) as alert_count  from mail_track mt where mt.CREATE_DATETIME between char((current date),ISO)||' 00:00:00.00' and char((current date ),ISO)||' 23:59:59.00'  and mt.combination_id IN (20000,20500,21000,1009,1005,22000,30000,35000,20100,20400,40000)  group by date(mt.CREATE_DATETIME), hour(mt.CREATE_DATETIME),mt.combination_id  ) T, tcadmin.alert_combination A  where A.alertcombination_id = T.combination_id  group by T.sent_date, T.sent_hour) K order by K.sent_date, K.sent_hour desc with ur 

--export to /home/datareq/generic_etl/logs/hourly_Alert_sent_stat.txt of del modified by coldel, datesiso select trim(char(K.sent_date)) ||left(' ',15 - length(Trim(char(K.sent_date)))) ||'|'|| trim(char(K.sent_hour)) ||left(' ',4 - length(Trim(char(K.sent_hour)))) ||'|'|| trim(char(K.A_20000)) ||left(' ',10 - length(Trim(char(K.A_20000)))) ||'|'|| trim(char(K.A_20500)) ||left(' ',10 - length(Trim(char(K.A_20500)))) ||'|'|| trim(char(K.A_21000)) ||left(' ',10 - length(Trim(char(K.A_21000)))) ||'|'||  trim(char(K.A_1009)) ||left(' ',10 - length(Trim(char(K.A_1009)))) ||'|'|| trim(char(K.A_1005)) ||left(' ',10 - length(Trim(char(K.A_1005)))) ||'|'|| trim(char(K.A_22000)) ||left(' ',10 - length(Trim(char(K.A_22000)))) ||'|'|| trim(char(K.A_30000)) ||left(' ',10 - length(Trim(char(K.A_30000)))) ||'|'|| trim(char(K.A_35000)) ||left(' ',10 - length(Trim(char(K.A_35000)))) ||'|'|| trim(char(K.A_20100)) ||left(' ',10 - length(Trim(char(K.A_20100)))) ||'|' ||trim(char(K.A_20400)) ||left(' ',10 - length(Trim(char(K.A_20400)))) ||'|' from   (select T.sent_date, T.sent_hour,  SUM(CASE WHEN A.alertcombination_id = 20000 THEN T.alert_count ELSE 0 END) as A_20000 ,  SUM(CASE WHEN A.alertcombination_id = 20500 THEN T.alert_count ELSE 0 END) as A_20500,  SUM(CASE WHEN A.alertcombination_id = 21000 THEN T.alert_count ELSE 0 END) as A_21000,  SUM(CASE WHEN A.alertcombination_id = 1009 THEN T.alert_count ELSE 0 END) as A_1009,  SUM(CASE WHEN A.alertcombination_id = 1005 THEN T.alert_count ELSE 0 END) as A_1005,  SUM(CASE WHEN A.alertcombination_id = 22000 THEN T.alert_count ELSE 0 END) as A_22000,  SUM(CASE WHEN A.alertcombination_id = 30000 THEN T.alert_count ELSE 0 END) as A_30000,  SUM(CASE WHEN A.alertcombination_id = 35000 THEN T.alert_count ELSE 0 END) as A_35000,  SUM(CASE WHEN A.alertcombination_id = 20100 THEN T.alert_count ELSE 0 END) as A_20100, SUM(CASE WHEN A.alertcombination_id = 20400 THEN T.alert_count ELSE 0 END) as A_20400 from (select date(mt.CREATE_DATETIME) as sent_date, hour(mt.CREATE_DATETIME) as sent_hour, mt.combination_id, count(1) as alert_count  from mail_track mt where mt.CREATE_DATETIME between char((current date),ISO)||' 00:00:00.00' and char((current date ),ISO)||' 23:59:59.00'  and mt.combination_id IN (20000,20500,21000,1009,1005,22000,30000,35000,20100,20400)  group by date(mt.CREATE_DATETIME), hour(mt.CREATE_DATETIME),mt.combination_id  ) T, tcadmin.alert_combination A  where A.alertcombination_id = T.combination_id  group by T.sent_date, T.sent_hour ) K order by K.sent_date, K.sent_hour desc with ur 


