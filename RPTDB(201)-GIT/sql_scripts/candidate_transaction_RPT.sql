MERGE INTO tcuser.tmp_post_01_nov_stage_1 t USING (select distinct u.login_id from user u, user_ad ua where u.login_create_date between '2012-11-01' and current date - 1 day and ua.login_id = u.login_id and ua.net_status = 20 ) ac ON (t.login_id = ac.login_id) WHEN NOT MATCHED THEN INSERT (Login_id) VALUES (ac.login_id)

export to /home/datareq/generic_etl/data_files/candidate_transaction_RPT.csv of del modified by coldel, datesiso select 1001 as id, 'Total Registration' as desc,(current date - 1 day) as LOGIN_CREATE_DATE, count(1) as candidate_count from user where login_create_date= current date - 1 day and login_id not like '%TRN%' and AGENT='I' union select 1002 as id, 'Total Stage 2 complete' as desc, posting_date as LOGIN_CREATE_DATE, count(distinct u.login_id) as candidate_count from user_ad u where posting_date= current date - 1 day and sub_cat_id=2711 and u.net_status=11 and source !='VEN' Group by posting_date union select 1003 as id , 'Stage 2 Previous Registration' as desc, ua.posting_date as LOGIN_CREATE_DATE, count(distinct ua.login_id) as candidate_count from user_ad ua where ua.posting_date = current date - 1 day and ua.sub_cat_id = 2711 and ua.net_status = 11 and not exists (select 1 from user u where u.login_id = ua.login_id and u.login_create_date = ua.posting_date) group by ua.posting_date union select 1004 as id, 'Stage 2 Same Day Registration' as desc,(current date - 1 day) as LOGIN_CREATE_DATE, count(distinct login_id) as candidate_count from user_ad ua where ua.posting_date = current date - 1 day and ua.sub_cat_id = 2711 and ua.net_status = 11 and exists (select 1 from user u where u.login_id = ua.login_id and u.login_create_date = ua.posting_date) union select 1005 as id, 'Stage 1 total 48L conversion' as desc, current date - 1 day as LOGIN_CREATE_DATE, count(distinct ua.login_id) as candidate_count from user_ad ua, tmp_search_ja_logins_48l a where ua.LAST_MODIFIED_TIME between '2012-11-01-00.00.00.000000' and char((current date - 1 day),ISO)||' 23:59:59.00' and ua.sub_cat_id = 2711 and ua.net_status = 11 and ua.login_id = a.login_id union select 1007 as id, 'Stage 1 Post Oct 31 conversion' as desc, current date - 1 day as LOGIN_CREATE_DATE,count(1) from tcuser.tmp_post_01_nov_stage_1 t, user_ad ua where ua.login_id = t.login_id and ua.net_status = 11 union select 1008 as id, 'Alert ready Registration' as desc, current date - 1 day as LOGIN_CREATE_DATE,sum(T.counts) from ( select count(1) as counts from user u, user_ad ua, rcrt_resume_ads rra where u.login_create_date = current date - 1 day and ua.login_id = u.login_id and ua.sub_cat_id = 2711 and ua.net_status = 20 and rra.ad_id = ua.ad_id and rra.DESCRIPTION_COMMENT is not null union all select count(1) as counts from user u, user_ad ua where u.login_create_date = current date - 1 day and ua.login_id = u.login_id and ua.sub_cat_id = 2711 and ua.net_status = 11 ) T with ur


