export to /home/datareq/generic_etl/logs/experience_breakup.txt of del modified by coldel, datesiso select trim(char(t.experience_rang))||left( ' ', 20 - length(trim(char(t.experience_rang))) )||':'||trim(char(t.native_resume))|| left( ' ', 20 - length(trim(char(t.native_resume))))||':'||trim(char(t.trans_resume))|| left( ' ', 20 - length(trim(char(t.trans_resume)))) ||':'||char(t.native_resume + t.trans_resume) from (select experience_rang,sum(native_resume) as native_resume, sum(trans_resume) as trans_resume from(select CASE WHEN rra.WORK_EXP between 0 and 2 then 'Work_exp_0_2' WHEN rra.WORK_EXP between 3 and 5 then 'Work_exp_3_5' WHEN rra.WORK_EXP between 6 and 10 then 'Work_exp_6_10' WHEN rra.WORK_EXP > 10 then 'Work_exp_10_plus' ELSE 'NOT DEFINED' END as experience_rang, count(1) as native_resume ,0 as trans_resume from SITE_INBOX_RESPONSE sir, RCRT_RESUME_ADS rra where sir.date_responded = current date - 1 day and rra.ad_id= sir.resume_id group by CASE WHEN rra.WORK_EXP between 0 and 2 then 'Work_exp_0_2' WHEN rra.WORK_EXP between 3 and 5 then 'Work_exp_3_5' WHEN rra.WORK_EXP between 6 and 10 then 'Work_exp_6_10' WHEN rra.WORK_EXP > 10 then 'Work_exp_10_plus' ELSE 'NOT DEFINED' END union select CASE WHEN rra.WORK_EXP between 0 and 2 then 'Work_exp_0_2' WHEN rra.WORK_EXP between 3 and 5 then 'Work_exp_3_5' WHEN rra.WORK_EXP between 6 and 10 then 'Work_exp_6_10' WHEN rra.WORK_EXP > 10 then 'Work_exp_10_plus' ELSE 'NOT DEFINED' END as experience_rang, 0 as native_resume,count(1) as trans_resume from EXTERNAL_JOB_RESPONSE sir, RCRT_RESUME_ADS rra where sir.date_responded between char(current date -1 day,ISO)||' 00:00:00.00' and char(current date -1 day,ISO)||' 23:59:59.99' and rra.ad_id = sir.resume_id group by CASE WHEN rra.WORK_EXP between 0 and 2 then 'Work_exp_0_2' WHEN rra.WORK_EXP between 3 and 5 then 'Work_exp_3_5' WHEN rra.WORK_EXP between 6 and 10 then 'Work_exp_6_10' WHEN rra.WORK_EXP > 10 then 'Work_exp_10_plus' ELSE 'NOT DEFINED' END )t1 group by experience_rang ) t with ur 

export to /home/datareq/generic_etl/logs/fa_breakup.txt of del modified by coldel, datesiso select trim(char(t.FUNCTION)) || left( ' ', 20 - length(trim(char(t.FUNCTION)))) || ':' || trim(char(t.native_count))|| left( ' ', 20 - length(trim(char(t.native_count)))) || ':' || trim(char(t.trans_count))|| left( ' ', 20 - length(trim(char(t.native_count)))) || ':' || trim(char(t.native_count + t.trans_count)) from( select FUNCTION,sum(native_count) as native_count,sum(trans_count) as trans_count from (select CASE WHEN (rja.job_function like '%35%' OR rja.job_function like '%36%') THEN 'IT' else 'NOT_IT' END as FUNCTION , count(1) as native_count ,0 as trans_count from SITE_INBOX_RESPONSE sir, rcrt_job_ads rja where sir.date_responded = current date - 1 day and rja.ad_id= sir.ad_id Group by CASE WHEN (rja.job_function like '%35%' OR rja.job_function like '%36%') THEN 'IT' else 'NOT_IT' END union select CASE WHEN (rja.job_function like '%35%' OR rja.job_function like '%36%') THEN 'IT' else 'NOT_IT' END as FUNCTION , 0 as native_count , count(1) as trans_count from EXTERNAL_JOB_RESPONSE sir, rcrt_job_ads rja where sir.DATE_RESPONDED between char(current date -1 day,ISO)||' 00:00:00.00' and char(current date -1 day,ISO)||' 23:59:59.99' and rja.AD_ID = sir.JOB_ID Group by CASE WHEN (rja.job_function like '%35%' OR rja.job_function like '%36%') THEN 'IT' else 'NOT_IT' END )t1 group by FUNCTION)t with ur
