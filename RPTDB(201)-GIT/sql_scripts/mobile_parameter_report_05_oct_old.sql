export to /home/datareq/generic_etl/data_files/mobile_parameter_report.csv of del modified by coldel, datesiso SELECT left(TITLE,35) ||left(LOGIN_TYPE,12) || CHAR(DATA) FROM ( select  'UNIQUE LOGINS FOR LAST 90 DAYS      ' as title, LU.LOGIN_TYPE  as LOGIN_TYPE,count(distinct LU.LOGIN_ID) as  data, 1 as order_field from LOGIN_USAGE_HISTORY LU where LU.LOGIN_TIME between current timestamp - 90 days and current timestamp AND LU.LOGIN_TYPE IN ('TJANDRD', 'TJIOS','TJMOB')  GROUP BY LU.LOGIN_TYPE UNION  select  'LOGINS EXP LESS THAN 2 YEARS    ' as title,LU.LOGIN_TYPE  as LOGIN_TYPE,count(distinct LU.LOGIN_ID) as  data, 2 as order_field from LOGIN_USAGE_HISTORY LU, USER_AD UA , RCRT_RESUME_ADS RRA where LU.LOGIN_TIME between current timestamp - 90 days and current timestamp AND LU.LOGIN_TYPE IN ('TJANDRD', 'TJIOS','TJMOB') AND UA.LOGIN_ID = LU.LOGIN_ID AND RRA.AD_ID = UA.AD_ID AND RRA.WORK_EXP <=2 GROUP BY LU.LOGIN_TYPE UNION  select  'LOGINS EXP MORE THAN 2 YEAR     ' as title, LU.LOGIN_TYPE  as LOGIN_TYPE,count(distinct LU.LOGIN_ID) as  data, 3 as order_field from LOGIN_USAGE_HISTORY LU, USER_AD UA , RCRT_RESUME_ADS RRA where LU.LOGIN_TIME between current timestamp - 90 days and current timestamp AND LU.LOGIN_TYPE IN ('TJANDRD', 'TJIOS','TJMOB') AND UA.LOGIN_ID = LU.LOGIN_ID AND RRA.AD_ID = UA.AD_ID AND RRA.WORK_EXP > 2 GROUP BY LU.LOGIN_TYPE UNION  select  'LOGINS MORE THAN 1 TIMES MOB    ' as title,T.LOGIN_TYPE as LOGIN_TYPE,count(distinct T.LOGIN_ID) as  data, 4 as order_field from (select LU.LOGIN_ID, LU.LOGIN_TYPE from LOGIN_USAGE_HISTORY LU where LU.LOGIN_TIME between current timestamp - 90 days   and current timestamp AND LU.LOGIN_TYPE IN ('TJANDRD', 'TJIOS','TJMOB') group by LU.LOGIN_ID, LU.LOGIN_TYPE HAVING count(LU.LOGIN_ID) > 1) T  group by T.LOGIN_TYPE  UNION  select  'LOGINS LESS THAN 2 TIMES MOB    ' as title, T.LOGIN_TYPE  as LOGIN_TYPE,count(distinct T.LOGIN_ID) as  data, 5 as order_field from (select LU.LOGIN_ID,LU.LOGIN_TYPE from LOGIN_USAGE_HISTORY LU where LU.LOGIN_TIME between current timestamp - 90 days and current timestamp AND LU.LOGIN_TYPE IN ('TJANDRD', 'TJIOS','TJMOB') group by LU.LOGIN_ID,LU.LOGIN_TYPE HAVING count(LU.LOGIN_ID) = 1) T GROUP BY T.LOGIN_TYPE UNION  select  'DAILY REGISTRATIONS MOBILE      ' as title, LU.LOGIN_TYPE as LOGIN_TYPE,count(distinct LU.LOGIN_ID) as  data, 6 as order_field from USER u,LOGIN_USAGE_HISTORY LU where u.LOGIN_SRL_NO = lu.LOGIN_SRL_NO and LOGIN_CREATE_DATE = current date - 1 day and REGISTRATION_SOURCE IN ('TJANDRD', 'TJIOS','TJMOB') GROUP BY LU.LOGIN_TYPE UNION  select  'TOTAL LOGINS                    ' as title, LU.LOGIN_TYPE as LOGIN_TYPE,count(distinct LU.LOGIN_ID) as  data, 7 as order_field from LOGIN_USAGE_HISTORY LU where LU.LOGIN_TYPE IN ('TJANDRD', 'TJIOS','TJMOB') GROUP BY LU.LOGIN_TYPE ) REP ORDER BY ORDER_FIELD ASC WITH UR



